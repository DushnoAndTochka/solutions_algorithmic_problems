# Dota2 Senate Solution

## Декомпозиция:

Задача имеет достаточно сложную формулироваку, поэтому я предлагаю начать именно с понимания, а что именно от нас хотят ? Хотят понять кто же победит. А как это понять ? Надо понять самую выгодную стратегию. Давайте с этого и начнем

Что там говорят правила ? 

> Каждый из сенаторов может делать всего две вещи.
>
>1. Запретить любому сенатору от противоположной фракции голосовать навсегда.
>2. В случае если сенаторы другой фракции больше не могут голосовать, объявить о своей победе.

Получается нам дается последовательность голосования сенаторов разных фракций, каждый из которых умеет делать вещи описанные выше. 

Какие могут быть стратегии ?

### Стратегия "зачистка".

Каждый сенатор будет "затыкать" самого левого сенатора из другой фракции

> Маленькими буквами помечу тех, кто уже не может голосовать.

```
RDDRRDD  // изначальный ряд
   |
   V
RdDRRDD  // первый запретил второму
   |
   V
rdDRRDD  // третий запретил первому
   |
   V
rddRRDD  // четвертый запретил третьему
   |
   V
rddRRdD  // пятый запретил шестому
   |
   V
rddrRdD  // седьмой запретил четвертому
   |
   V
rddrRdd  // пятый запретил последнему

// победа R
```

Многие шаги опущены. Например второй уже не мог голосовать, так как первый ему запретил это, поэтому мы его пропустили.

В данном решении видно как это работает и как мы приходим к результату, теперь стоит задуматься, будет ли это оптимальной стратегией ???

Ответ: нет.

Почему ? Об этом следующая стратегия.

### Стратегия "перспектива".

Предыдущая стратегия плоха тем, что сенаторы запрещают голосовать сенаторам, которые уже проголосовали в этом круге и до следующего круга голосования они `безобидны`. Тогда зачем им запрещать голосовать, если впереди есть `опасные` сенаторы противоположной фракции ?

Идея следующая, мьютим всех кто потенциально может навредить в этом раунде.

```
RDDRRDD  // тот же самый ряд
   |
   V
RdDRRDD  // первый запретил второму
   |
   V
RdDrRDD  // третий запретил четвертому
   |
   V
RdDrRdD  // пятый запретил шестому
   |
   V
rdDrRdD  // седьмой запретил ПЕРВОМУ
   |
   V
rdDrrdD  // третий запретил пятому

// победа D
```

Внезапно победитель поменялся и теперь уже `Dire` победили.

>Более оптимальной стратегии я не смог придумать. Данная стратегия является самой оптимальной для обеих сторон.

## Описание:

Определились с стратегией, берем стратегию "перспектива".

Теперь давайте подумаем как можно было бы решить данную задачу ?

### Решение через очередь.

У нас есть последовательность голосования или же другими словами очередь в которой сенаторы имеют голосов и из которой могут вывалиться. Сама задача нас подводит к тому, что стоит попробовать использовать очередь.

```python
class Solution:
    def predictPartyVictory(self, senate: str) -> str:
        # заиспользуем deque. Идеально подходит.
        voting_queue = deque(senate)

        # Нам надо понимать когда остановиться.
        d_senator_count = voting_queue.count('D')
        r_senator_count = len(senate) - d_senator_count

        # Выступает в качестве маркера бана.
        ban_d = ban_r = 0

        # Если еще в фракциях есть кому голосовать, то продолжаем.
        # Если же хоть в одной закончатся сенаторы, то победитель найден.
        while r_senator_count and d_senator_count:
            # Достаем сенатора из очереди
            voting_senator = voting_queue.popleft()
            if voting_senator == 'R':
                # Если попался сенатор редиант, 
                # то смотрим может ли данный сенатор голосовать. 
                # Это определяется через кол-во бана от 
                # противоположной фракции.
                if ban_r == 0:
                    # раз проголосовал, 
                    # значит добавляем на следующий круг голосования.
                    voting_queue.append(voting_senator)
                    # Помечаем, что он забанил ближайшего сенатора
                    # другой фракции.
                    ban_d += 1
                else:
                    # Выходит что данный сенатор уже в бане. 
                    ban_r -= 1
                    # Уменьшаем кол-во тех, кто моежт проголосовать.
                    r_senator_count -= 1
            else:
                # тоже самое что и выше
                if ban_d == 0:
                    voting_queue.append(voting_senator)
                    ban_r += 1
                else:
                    ban_d -= 1
                    d_senator_count -= 1

        # смотрим у кого остались сенаторы. Это определяет победителя.
        return 'Dire' if d_senator_count else 'Radiant'
```

### Решение через "круги" голосования.

Мы можем сделать почти тоже самое что и выше, только через круги голосования.

Это так же вытекает из задачи. Мы можем понять кто и кого забанил на первом круге и собрать всех, кто будет голосовать на втором и так далее.


```python
class Solution:
    def predictPartyVictory(self, senate: str) -> str:
        # список голосующих в текущем круге
        voting_round = list(senate)
        # Выступает в качестве маркера бана.
        ban_d = ban_r = 0
        while True:
            # формируем список на следующий круг
            senat_in_next_round = []
            for i in voting_round:
                if i == 'R':
                    # история вточности как в предыдущем решении
                    if ban_r == 0:
                        # если смог проголосовать, 
                        # значит стоит добавить на следующий круг голосования
                        senat_in_next_round.append(i)
                        ban_d += 1
                    else:
                        ban_r -= 1
                else:
                    if ban_d == 0:
                        senat_in_next_round.append(i)
                        ban_r += 1
                    else:
                        ban_d -= 1          
            # если текущий и следующие круги одинаковой длины, 
            # значит всех уже побанили и осталось найти победителя  
            if len(voting_round) == len(senat_in_next_round):
                return 'Radiant' if senat_in_next_round[0] == 'R' else 'Dire'

            voting_round = senat_in_next_round
```

## PS
Я бы не стал отмечать сильные и слабые стороны каждого из решений. 
Решение с очередью выглядит чуть более оптимальным, но не более.
Так же есть еще несколько инетересных решений, например решение через рекурсию, 
которая тоже тут напрашивается, но расписывать из я не буду.
О них вы можете почитать прям на [LeetCode](https://leetcode.com/problems/dota2-senate/editorial/).

Спасибо что дочитали до конца.